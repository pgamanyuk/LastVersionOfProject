window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#mail"),t=document.querySelector("#pass"),s=document.querySelector("#confirmPass"),o=document.querySelector("#btnSend"),i=document.querySelector("#mailError"),a=document.querySelector("#passError"),n=document.querySelector("#passMatchError"),c=document.querySelector("#errorMessage");function d(e){const t=document.querySelector("#errorMessageGoogle");axios.post("http://localhost:8000/decodejwtgoogleup",{token:e.credential}).then(e=>{e.data.message?(t.innerHTML=e.data.message,t.classList.toggle("hide"),setTimeout(()=>{t.classList.toggle("hide")},4e3)):(localStorage.setItem("token",e.data.token),location.href="../chat/index.html")}).catch(e=>{console.log(e)})}!function(){VK.init({apiId:7982119});const e=document.querySelector("#errorMessageGoogle");document.querySelector("#vk_auth").addEventListener("click",t=>{t.preventDefault(),VK.Auth.login((function(t){t.session?axios.post("http://localhost:8000/checkSocialId",{id:t.session.user.id,social:"vk"}).then(s=>{s.data.message?(e.innerHTML=s.data.message,e.classList.toggle("hide"),setTimeout(()=>{e.classList.toggle("hide")},4e3)):location.href=`https://localhost:80/set-mail/index.html?id=${t.session.user.id}&social=vk`}).catch(e=>{console.log(e)}):console.log(1)}))})}(),google.accounts.id.initialize({client_id:"341269728044-13kn13rnm4k57nvj2n7mi73q9od4docv",callback:d}),google.accounts.id.renderButton(document.getElementById("buttonDiv"),{type:"icon"}),window.fbAsyncInit=function(){FB.init({appId:"394717829027741",cookie:!0,xfbml:!0,version:"v1.0"}),FB.AppEvents.logPageView()},document.querySelector("#fb_auth").addEventListener("click",e=>{e.preventDefault(),FB.login((function(e){e.authResponse.userID?(axios.post("http://localhost:8000/checkSocialId",{id:e.authResponse.userID,social:"fb"}).then(t=>{t.data.message?(c.innerHTML=t.data.message,c.classList.toggle("hide"),setTimeout(()=>{c.classList.toggle("hide")},4e3)):location.href=`https://localhost:80/set-mail/index.html?id=${e.authResponse.userID}&social=fb`}).catch(e=>{console.log(e)}),l):console.log(1)}))}),e.addEventListener("blur",()=>{/\S+@\S+\.\S+/.test(e.value)||i.classList.remove("hide")},!0),e.addEventListener("focus",()=>{i.classList.add("hide")},!0),e.addEventListener("input",()=>{i.classList.contains("hide")&&a.classList.contains("hide")&&n.classList.contains("hide")&&e.value&&t.value&&t.value===s.value?o.removeAttribute("disabled"):o.setAttribute("disabled","disabled")}),t.addEventListener("blur",()=>{/(?=.*[0-9])(?=.*[A-Z])[0-9a-zA-Z]{8,}/g.test(t.value)||a.classList.remove("hide")},!0),t.addEventListener("focus",()=>{a.classList.add("hide")},!0),t.addEventListener("input",()=>{i.classList.contains("hide")&&a.classList.contains("hide")&&n.classList.contains("hide")&&e.value&&t.value&&t.value===s.value?o.removeAttribute("disabled"):o.setAttribute("disabled","disabled")}),s.addEventListener("blur",()=>{t.value!==s.value&&n.classList.remove("hide")},!0),s.addEventListener("focus",()=>{n.classList.add("hide")},!0),s.addEventListener("input",()=>{i.classList.contains("hide")&&a.classList.contains("hide")&&n.classList.contains("hide")&&e.value&&t.value&&t.value===s.value?o.removeAttribute("disabled"):o.setAttribute("disabled","disabled")});const r=document.querySelectorAll(".passwordIcon");r.forEach((e,o)=>{e.addEventListener("click",()=>{e.classList.toggle("icon-hide"),0===o?(r[1].classList.toggle("icon-hide"),t.setAttribute("type","text"),s.setAttribute("type","text")):(r[0].classList.toggle("icon-hide"),t.setAttribute("type","password"),s.setAttribute("type","password"))})}),o.addEventListener("click",o=>{o.preventDefault(),c.classList.add("hide");const i=e.value;let a="";const l=t.value,n=(s.value,document.querySelector("#newLoader"));for(let t=0;t<e.value.length&&"@"!==i[t];t++)a+=i[t];n.classList.toggle("hide"),axios.post("http://localhost:8000/signup",{mail:i,password:l,login:a}).then((function(e){n.classList.toggle("hide"),e.data.message?(c.innerHTML=e.data.message,c.classList.toggle("hide"),setTimeout(()=>{c.classList.toggle("hide")},4e3)):console.log("zaebumba")})).catch((function(e){console.log(e),n.classList.toggle("hide")}))})});